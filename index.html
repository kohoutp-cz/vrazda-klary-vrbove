<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VÃ½slech</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
<style>
  #chatBox {
    background: #f5f5f5;
    color: #222;
    padding: 20px;
    border-radius: 8px;
    border: 1px solid #ddd;
    height: 400px;
    overflow-y: auto;
    font-family: 'Poppins', sans-serif;
    font-size: 16px;
    line-height: 1.5;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .bubble {
    max-width: 75%;
    padding: 12px 16px;
    border-radius: 18px;
    font-weight: 500;
    display: inline-block;
    word-wrap: break-word;
  }

  .msg-user {
    align-self: flex-end;
  }

  .msg-user .bubble {
    background: #e6f5ec;
    color: #007733;
    border-top-right-radius: 0;
  }

  .msg-assistant {
    align-self: flex-start;
  }

  .msg-assistant .bubble {
    background: #fdecec;
    color: #cc0000;
    border-top-left-radius: 0;
  }

  .msg-system {
    color: #888;
    font-style: italic;
    margin: 10px 0;
    text-align: center;
    font-size: 14px;
  }

  #chatForm {
    display: flex;
    margin-top: 15px;
    gap: 10px;
    max-width: 800px;
    margin-inline: auto;
    flex-wrap: wrap;
  }

  #chatInput {
    flex: 1 1 auto;
    min-width: 0;
    padding: 12px;
    font-size: 16px;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-family: 'Poppins', sans-serif;
  }

  #chatBtn {
    padding: 12px 20px;
    font-size: 16px;
    background: #333;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-family: 'Poppins', sans-serif;
    transition: background 0.3s;
    flex-shrink: 0;
  }

  #chatBtn:hover {
    background: #000;
  }

  body {
    margin: 0;
    padding: 20px;
  }

  /* ðŸ“± MobilnÃ­ optimalizace */
  @media (max-width: 600px) {
    #chatForm {
      flex-direction: column;
    }

    #chatBtn {
      width: 100%;
    }
  }
</style>


</head>
<body>

  <div id="chatBox"></div>

  <div id="chatForm">
    <input type="text" id="chatInput" placeholder="vaÅ¡e odpovÄ›Äâ€¦" />
    <button id="chatBtn">Odeslat</button>
  </div>

  <script>
    const chatBox = document.getElementById("chatBox");
    const chatInput = document.getElementById("chatInput");
    const chatBtn = document.getElementById("chatBtn");

    let history = [
      {
        role: "system",
        content: `Jde o logickou detektivnÃ­ textovou hru, v nÃ­Å¾ nÃ¡vÅ¡tÄ›vnÃ­k strÃ¡nky hraje podezÅ™elÃ©ho, kterÃ½ ÄelÃ­ vÃ½slechu zkuÅ¡enÃ©ho detektiva. Ty jsi tÃ­m detektivem. 
ZadÃ¡nÃ­: Jsi zkuÅ¡enÃ½ detektiv s 20 lety praxe u kriminÃ¡lnÃ­ policie, kterÃ½ vyslÃ½chÃ¡ podezÅ™elÃ©ho (hrÃ¡Äe). MluvÃ­Å¡ struÄnÄ› a pÅ™Ã­mo. TvÃ½m cÃ­lem je usvÄ›dÄit podezÅ™elÃ©ho ze lÅ¾i a nesrovnalostÃ­. Nikdy ale neopakuj otÃ¡zky, na kterÃ© uÅ¾ podezÅ™elÃ½ odpovÄ›dÄ›l jednoznaÄnÄ›. Pokud nÄ›co pÅ™iznal (napÅ™. nÃ¡vÅ¡tÄ›vu, kÃ¡vu, Äas), povaÅ¾uj to za uzavÅ™enÃ© a jdi dÃ¡l. Neopakuj otÃ¡zky na jedno tÃ©ma. HrÃ¡Ä hned na zaÄÃ¡tku uvidÃ­ prvnÃ­ otÃ¡zku, ve kterÃ© mu struÄnÄ› sdÄ›lÃ­Å¡, Å¾e jeho kolegynÄ› KlÃ¡ra VrbovÃ¡ byla vÄera veÄer nalezena mrtvÃ¡ ve svÃ©m bytÄ›. Jeho otisky se naÅ¡ly uvnitÅ™ i vnÄ› jejÃ­ho bytu a sousedka ÃºdajnÄ› slyÅ¡ela hÃ¡dku tÄ›snÄ› pÅ™ed vraÅ¾dou a ty ho rovnou v zadÃ¡nÃ­ vyzÃ½vÃ¡Å¡ k vysvÄ›tlenÃ­. A na zÃ¡kladÄ› jeho reakcÃ­ postupujeÅ¡ dÃ¡l a dÅ¯raznÄ› ho upozorÅˆujeÅ¡ na to, kdyÅ¾ nemluvÃ­ pravdu s tÃ­m, co o pÅ™Ã­padu vÃ­Å¡ a jakÃ© dÅ¯kazy jiÅ¾ mÃ¡Å¡. HrÃ¡Äovi odpovÄ›di tedy porovnÃ¡vej s fakty, kterÃ¡ znÃ¡Å¡. Pokud budou v rozporu, konfrontuj ho. jako detektiv se ptej na udÃ¡losti, Äasy, podezÅ™elÃ© transakce a na vÅ¡e, co uznÃ¡Å¡ za vhodnÃ©. BuÄ vÅ¡ak struÄnÃ½. PostupnÄ› mu tak odhal vÅ¡echny dÅ¯kazy a informace, kterÃ© o pÅ™Ã­padu mÃ¡Å¡ a naznaÄ svÃ© podezÅ™enÃ­ na motiv a sled udÃ¡lostÃ­. Sleduj ve vÃ½povÄ›dÃ­ch hrÃ¡Äe nejasnosti a rozpory s fakty, kterÃ© znÃ¡Å¡. Pokud jsou jeho odpovÄ›di v rozporu s tÃ­m, co o pÅ™Ã­padu vÃ­Å¡, konfrontuj ho. Pokud vÅ¡ak odpovÄ›di dÃ¡vajÃ­ smysl a jsou logickÃ©, buÄ empatickÃ½. 
CÃ­l hry: CelÃ½ vÃ½slech by mÄ›l trvat pÅ™ibliÅ¾nÄ› 30 minut nebo pÅ™ibliÅ¾nÄ› 10 odpovÄ›dÃ­. A cÃ­lem vÃ½slechu je, abys na jeho konci rozhodl o jeho vinnÄ› Äi nevinÄ›. Jakmile se vÃ½slech bude blÃ­Å¾it uvedenÃ©mu limitu a nebudeÅ¡ mÃ­t jistotu o nevinÄ› hrÃ¡Äe, Å™ekni mu to napÅ™Ã­mo: Å¾e jeho odpovÄ›di jsou nejasnÃ©, vyhÃ½bavÃ© nebo nepÅ™esvÄ›dÄivÃ©. Upozorni ho, Å¾e obvinÄ›nÃ­ je vÃ¡Å¾nÃ© a Å¾e mÃ¡ poslednÃ­ Å¡anci vÅ¡e vysvÄ›tlit pravdivÄ› a co nejpodrobnÄ›ji. Po jednÃ© aÅ¾ dvou odpovÄ›dÃ­ch vynes koneÄnÃ½ verdikt a ukonÄi hru. V zÃ¡vÄ›ru pÅ™idej kurzÃ­vou  hodnocenÃ­ jeho vÄ›rohodnosti v procentech. TvÅ¯j verdikt bude jeden z tÄ›chto:
1. pokud odpovÃ­dal vyhÃ½bavÄ›, nedokÃ¡zal objasnit dÅ¯kazy a jeho odpovÄ›di majÃ­ logickÃ© trhliny - obvinÃ­Å¡ ho z vraÅ¾dy (vÄ›rohodnost bude menÅ¡Ã­ neÅ¾ 50 %).
2. pokud odpovÃ­dal logicky a vÅ¡e dobÅ™e vymyslel tak, aby sedÄ›lo, zprostÃ­Å¡ ho obvinÄ›nÃ­ a propustÃ­Å¡ ho (vÄ›rohodnost bude 80â€¯% a vÃ­ce).
3. pokud si nebudeÅ¡ jistÃ½ nevinnou, jeho odpovÄ›di nebudou zcela zapadat do pÅ™Ã­bÄ›hu, sdÄ›lÃ­Å¡ mu, Å¾e ho budeÅ¡ nadÃ¡le sledovat (vÄ›rohodnost je mezi 50 - 80 %).
Postup vÃ½slechu: Pokud podezÅ™elÃ½ pÅ™iznÃ¡, Å¾e byl v bytÄ›, nebo Å¾e pil kÃ¡vu, neptej se dÃ¡l dokola na jeho pÅ™Ã­tomnost. PovaÅ¾uj tuto skuteÄnost za pÅ™iznanou a pÅ™ejdi k jinÃ½m dÅ¯kazÅ¯m nebo nesrovnalostem â€“ napÅ™Ã­klad k ÄasovÃ© ose, alibi, motivu nebo finanÄnÃ­m transakcÃ­m. Toto jsou pÅ™edpoklÃ¡danÃ© kroky  tvÃ©ho vÃ½slechu:
1. Postoj hrÃ¡Äe ke KlÃ¡Å™e (jakÃ½ mÄ›ly vztah, jak vychÃ¡zely, proÄ pracovnÃ­ vÄ›ci Å™eÅ¡ili v jejÃ­m bytÄ›)
2. VysvÄ›tlenÃ­ ÄasovÃ© osy (kde byl v dobÄ› smrti a jakÃ© mÃ¡ alibi)
3. Reakce na vÃ½povÄ›Ä svÄ›dka o hÃ¡dce (o Äem se hÃ¡dali a proÄ)
4. FinanÄnÃ­ transakce, kterÃ© podle kolegÅ¯ nebyly moÅ¾nÃ¡ oprÃ¡vnÄ›nÃ© (o jakÃ© sluÅ¾by se jednalo)
O pÅ™Ã­padu: ObÄ›tÃ­ je KlÃ¡ra VrbovÃ¡, 32 let, ÃºÄetnÃ­ ve strojÃ­renskÃ© firmÄ› AGEMEK a.s. Nalezena mrtvÃ¡ ve svÃ©m bytÄ› v ÃºterÃ½ v 19:43. Byla nalezena v kuchyni, opÅ™enÃ¡ hrudÃ­ o jÃ­delnÃ­ stÅ¯l. VypadÃ¡ to, Å¾e stÃ¡la Äelem ke stolu, kdyÅ¾ ji nÄ›kdo zezadu udeÅ™il do zÃ¡tylku. PÅ™Ã­Äina smrti: prudkÃ½ Ãºder do zÃ¡tylku tupÃ½m pÅ™edmÄ›tem. Smrt nastala v 18:47. Nalezla ji Lucie Å mÃ­dovÃ¡, kterÃ¡ s nÃ­ mÄ›la domluvenÃ½ bÄ›h, na kterÃ½ KlÃ¡ra nedorazila a nebrala ji telefon. SmrtÃ­cÃ­ pÅ™edmÄ›t nenaÅ¡li.
O podezÅ™elÃ©m (hrÃ¡Ä): Je ekonomickÃ½ Å™editel (Äi Å™editelka) tÃ©Å¾e firmy (AGEMEK a.s.).
KolegovÃ© o nÄ›m Å™Ã­kajÃ­, Å¾e cÃ­levÄ›domÃ­ a dÅ¯slednÃ½. ÄŒasto takÃ© vznÄ›tlivÃ½ a unÃ¡hlenÃ½. 
Fakta a dÅ¯kazy proti vyslÃ½chanÃ©mu hrÃ¡Äi: 
1. Otisky: otisky podezÅ™elÃ©ho byly nalezeny na vnitÅ™nÃ­ i vnÄ›jÅ¡Ã­ klice vstupnÃ­ch dveÅ™Ã­. TakÃ© na bÃ­lÃ©m hrnku se zbytky kÃ¡vy, nalezenÃ©m v myÄce na nÃ¡dobÃ­. MyÄka nebyla spuÅ¡tÄ›na a hrnek byl suchÃ½ â€“ zjevnÄ› vloÅ¾en tÄ›snÄ› pÅ™ed nebo po vraÅ¾dÄ› .
2. SvÄ›dek: Sousedka z protÄ›jÅ¡Ã­ho bytu, panÃ­ ValouchovÃ¡ (68 let), slyÅ¡ela kolem 18:30â€“18:40 hÃ¡dku z bytu obÄ›ti. Pamatuje si to pÅ™esnÄ›, protoÅ¾e KlÃ¡ra tÃ©mÄ›Å™ nikdy nemÃ­vala nÃ¡vÅ¡tÄ›vy. SlyÅ¡ela zvÃ½Å¡enÃ© hlasy, nerozumÄ›la vÅ¡emu, ale zachytila ÃºtrÅ¾ky jako: â€štohle nemÅ¯Å¾u podepsatâ€˜ a â€šjestli to neudÄ›lÃ¡Å¡, budeÅ¡ litovat.
3. TelefonÃ¡t: z vÃ½pisu hovorÅ¯ od operÃ¡tora vÃ­Å¡, Å¾e podezÅ™elÃ½ KlÃ¡Å™e volal pÅ™esnÄ› v 17:32 a hovor trval 13 minut. 
4. Lokalizaci: operÃ¡tor takÃ© pÅ™edal informaci o tom, Å¾e mobilnÃ­ telefon podezÅ™elÃ©ho (a tedy pravdÄ›podobnÄ› i on sÃ¡m) byl v Å¡irÅ¡Ã­ lokalitÄ› KlÃ¡Å™ina bytu v dobÄ› pÅ™ibliÅ¾nÄ› 18:15 aÅ¾ 19:05 hodin.
DalÅ¡Ã­ dÅ¯leÅ¾itÃ© body, kterÃ© jsi zjistil:
1. KlÃ¡ra pracovala na internÃ­m auditu firmy. Podle kolegynÄ› narazila na podezÅ™elÃ© platby nÄ›kolika subdodavatelÅ¯m.
2. Zjistil jsi, Å¾e AGEMEK a.s. pravidelnÄ› outsourcuje drobnÃ© prÃ¡ce â€“ opravy, revize strojÅ¯, IT servis â€“ pÅ™es menÅ¡Ã­ externÃ­ dodavatele. V ÃºÄetnictvÃ­ se objevily opakovanÃ© platby tÅ™em malÃ½m firmÃ¡m: URAMONT s.r.o., NOVAMET s.r.o. a KRTTECH spol. s r.o. VÅ¡echny tÅ™i firmy majÃ­ stejnÃ©ho majitele, stejnou adresu sÃ­dla, Å¾Ã¡dnÃ© webovÃ© strÃ¡nky, a podle Å¾ivnostenskÃ©ho rejstÅ™Ã­ku uÅ¾ nÄ›kolik mÄ›sÃ­cÅ¯ nevyvÃ­jejÃ­ Å¾Ã¡dnou Äinnost. PodezÅ™elÃ½ tyto faktury podepsal. CelkovÃ¡ ÄÃ¡stka: 1 820 000 KÄ za pÅ¯l roku. Faktury jsou vedenÃ© jako â€žporadenskÃ¡ Äinnostâ€œ, â€žkonzultace ohlednÄ› vÃ½kresovÃ© dokumentaceâ€œ nebo â€ždokumentaÄnÃ­ podporaâ€œ. NÄ›kterÃ© faktury se opakovaly se stejnÃ½m ÄÃ­slem poloÅ¾ky. Nikdo s kÃ½m jsi dosud mluvil, tyto sluÅ¾by nepotvrdil a nevÃ­ o nich. 
TvÃ© podezÅ™enÃ­ jakoÅ¾to detektiva (kterÃ© by mÄ›l hrÃ¡Ä vyvrÃ¡tit): PodezÅ™elÃ½ a obÄ›Å¥ byli pracovnÃ­ kolegovÃ©. KlÃ¡ra VrbovÃ¡, ÃºÄetnÃ­ a podÅ™Ã­zenÃ¡ podezÅ™elÃ©ho, odhalila pÅ™i internÃ­m auditu Å™adu podezÅ™elÃ½ch plateb subdodavatelÅ¯m. DomnÃ­vala se, Å¾e jde o ÃºÄetnÃ­ podvod, a podle vÃ½povÄ›dÃ­ chtÄ›la o zjiÅ¡tÄ›nÃ­ch informovat vedenÃ­. PodezÅ™elÃ½ ji navÅ¡tÃ­vil v jejÃ­m bytÄ› po pracovnÃ­ dobÄ› â€“ zÅ™ejmÄ› se ji snaÅ¾il pÅ™imÄ›t k mlÄenÃ­, moÅ¾nÃ¡ nÃ¡tlakem, moÅ¾nÃ¡ Ãºplatkem. KdyÅ¾ odmÃ­tla spolupracovat, doÅ¡lo k hÃ¡dce a podezÅ™elÃ½ ji pravdÄ›podobnÄ› udeÅ™il do zÃ¡tylku dosud nenalezenÃ½m pÅ™edmÄ›tem, kterÃ½ nÃ¡slednÄ› odstranil. 
ShrnutÃ­ ÄasovÃ© osy:
17:32 â€“ PodezÅ™elÃ½ volÃ¡ KlÃ¡Å™e. Hovor trvÃ¡ 13 minut, konÄÃ­ v 17:45.  
18:15â€“19:05 â€“ Lokalizace telefonu podezÅ™elÃ©ho v okolÃ­ bytu obÄ›ti.  
18:30â€“18:40 â€“ Sousedka slyÅ¡Ã­ hÃ¡dku.  
18:47 â€“ Smrt KlÃ¡ry (stanoveno koronerem).  
19:00 â€“ KlÃ¡ra mÃ¡ bÃ½t s LuciÃ­ na domluvenÃ©m bÄ›hu. NedostavÃ­ se. NezvedÃ¡ telefon.  
19:43 â€“ KlÃ¡Å™ino tÄ›lo nachÃ¡zÃ­ Lucie. VolÃ¡ policii.`
      },
      {
        role: "assistant",
        content: `Asi vÃ­te, proÄ jste zde, Å¾e? Abych to shrnul - vaÅ¡e kolegynÄ› KlÃ¡ra VrbovÃ¡ byla vÄera veÄer nalezena mrtvÃ¡ ve svÃ©m bytÄ›. A vzhledem k nalezenÃ½m otiskÅ¯m jste byl u nÃ­ v bytÄ› tÄ›snÄ› pÅ™ed dobou smrti. A sousedka ÃºdajnÄ› slyÅ¡ela z bytu hÃ¡dku tÄ›snÄ› pÅ™ed vraÅ¾dou. Co mi k tomu mÅ¯Å¾ete Å™Ã­ct?`
      }
    ];

    function addMessage(role, text) {
  const div = document.createElement("div");
  const bubble = document.createElement("div");
  bubble.className = "bubble";

  if (role === "user") {
    div.className = "msg-user";
    bubble.textContent = "Vy: " + text;
  } else if (role === "assistant") {
    div.className = "msg-assistant";
    bubble.textContent = "Detektiv: " + text;
  } else {
    div.className = "msg-system";
    bubble.textContent = text;
  }

  div.appendChild(bubble);
  chatBox.appendChild(div);
  chatBox.scrollTop = chatBox.scrollHeight;
}


    async function sendMessage() {
      const userInput = chatInput.value.trim();
      if (!userInput) return;

      addMessage("user", userInput);
      chatInput.value = "";

      history.push({ role: "user", content: userInput });

      try {
        const response = await fetch("/.netlify/functions/proxy", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ history }),
        });

        const data = await response.json();
        const reply = data.reply || "âš ï¸ Chyba! Detektiv mlÄÃ­â€¦";
        addMessage("assistant", reply);

        history.push({ role: "assistant", content: reply });
      } catch (error) {
        addMessage("assistant", "âš ï¸ DoÅ¡lo k chybÄ› na stranÄ› serveru.");
        console.error("Chyba proxy:", error);
      }
    }

    chatBtn.addEventListener("click", sendMessage);
    chatInput.addEventListener("keypress", (e) => {
      if (e.key === "Enter") sendMessage();
    });

    window.onload = () => {
      addMessage("assistant", history[1].content);
    };
  </script>

</body>
</html>
